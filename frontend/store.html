<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div>
        <form style="display: flex; flex-direction: column;" id="form">
            <input type="text" id="word">
            <label for="word" id="word-label"> Type word</label>
            <input type="definition" id="definition">
            <label for="" id="definition-label">Write definition</label>
            <button type="submit" id="submit-button"> submit </button>
        </form>
        <div>
            <p id="message"></p>
        </div>
    </div>
</body>
<script type="module">
    import {Validation} from "./utility.js"
    const form = document.getElementById("form");
    const message = document.getElementById("message")
    form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const wordInput = document.getElementById("word").value
        const wordLabel = document.getElementById("word-label")
        const definitionLabel  = document.getElementById("definition-label")
        const definitionInput = document.getElementById("definition").value
        if (Validation.validate(wordInput) && Validation.validate(definitionInput)) {
            const formInfo = {
                word : wordInput,
                definition : definitionInput
            }
            const response = await fetch("http://localhost:8000/definitions/", {
                method: "POST",
                headers: {
                        "Content-Type": "application/json" 
                    },
                body:  JSON.stringify(formInfo)
            });
            if (response.ok) {
                console.log("ok")
                const data = await response.json();
                message.innerHTML = data.message
                
            } else {
                console.log("nah")
            }
        } else {
            if (!Validation.validate(wordInput)) {
                wordInput.style.borderColor = "red"
                wordLabel.innerHTML = "Please provide a word"
                wordLabel.style.color = "red"
            } if(!Validation.validate(definitionInput)) {
                definitionInput.style.borderColor = "red"
                definitionLabel.innerHTML = "Please provide a definition"
                definitionLabel.style.color = "red"
            }

        }


    })
    
    
</script>
</html>